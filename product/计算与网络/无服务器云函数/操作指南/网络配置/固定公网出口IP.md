# 固定公网出口 IP

在很多场景下，用户会在云函数中访问数据库、微信公众号的 API 接口、其他第三方的服务等，这些服务往往需要配置 IP 白名单，这个时候就可以开启云函数的固定公网出口 IP 功能。

## 配置方法

1. 由于 EIP 资源比较稀缺，该功能目前在白名单控制阶段，需要的用户需要[**申请使用**](https://cloud.tencent.com/apply/p/lvesun64a7f)。
2. 审批通过后（通常在1~3个工作日左右），用户即可在**函数配置**页签下，单击【编辑】进行网络配置。
>
>1. 固定公网出口 IP 功能开启前，必须先使能公网访问功能；
>2. 同时开启私有网络和外网访问时，则固定公网出口IP功能会强制使能。
>
![网络配置](https://main.qcloudimg.com/raw/eea97ec602d1b5e210a1b81e96026a02.jpg)

## 功能介绍

1. 当在**函数配置**页面中，启用固定公网出口IP功能后，该云函数将会被随机分配一个公网弹性IP，且云函数中访问公网的流量，将会统一基于该 EIP 进行转发。
2. 当同时开启私有网络和外网访问时，访问公网的流量会基于 EIP转发，访问内网的流量会基于 VPC 转发。

## 使用限制

1. 随机生成的公网弹性IP，用户无法进行手动选择且自由更改。
2. 公网弹性 IP 会基于命名空间共享。也即同一命名空间下，开启固定公网出口IP功能的函数将共享该弹性IP；同时在同一命名空间下，当去使能所有函数的固定公网出口IP功能后，再使能该功能，则会随机产生一个新的弹性IP。
3. 公网弹性 IP 会基于私有网络的子网共享，也即同一命名空间下的某个云函数既配置了私有网络，且同时开启了固定公网出口IP功能，则公网弹性 IP 会随机生成一个新的，且会基于该私有网络的子网共享。
4. 公网弹性 IP 和函数的绑定关系对应如下：

| 网络配置 | 命名空间 A/函数 a | 命名空间 A/函数 b | 命名空间 B/函数 c | 命名空间 B/函数 d |
|----------|----------|----------|---------|----------|
| 仅公网访问 | 无公网弹性IP | 无公网弹性IP | 无公网弹性IP | 无公网弹性IP |
| 仅私有网络访问 | 无公网弹性IP | 无公网弹性IP | 无公网弹性IP | 无公网弹性IP |
| 公网访问且固定公网出口IP | 弹性IP-x | 弹性IP-x | 弹性IP-y | 弹性IP-y |
| 私有网络访问且固定公网出口IP | 弹性IP-z | 弹性IP-z | 弹性IP-z | 弹性IP-z |
